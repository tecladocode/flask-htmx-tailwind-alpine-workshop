
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../06-read-status/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.2">
    
    
      
        <title>Updating far away elements - Rapid Development with Flask, HTMX, TailwindCSS, and AlpineJS</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#updating-far-away-elements" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Rapid Development with Flask, HTMX, TailwindCSS, and AlpineJS" class="md-header__button md-logo" aria-label="Rapid Development with Flask, HTMX, TailwindCSS, and AlpineJS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Rapid Development with Flask, HTMX, TailwindCSS, and AlpineJS
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Updating far away elements
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Rapid Development with Flask, HTMX, TailwindCSS, and AlpineJS" class="md-nav__button md-logo" aria-label="Rapid Development with Flask, HTMX, TailwindCSS, and AlpineJS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Rapid Development with Flask, HTMX, TailwindCSS, and AlpineJS
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome!
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-index/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rapid Project Setup
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-partials-vs-components/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Partials vs. Components?
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-website-without-reloading/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A Website without Reloading
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-dynamic-pagination/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Simple, dynamic pagination with HTMX
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-adding-feeds/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adding new RSS feeds
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-read-status/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Entry read status indicator
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Updating far away elements
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Updating far away elements
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#updating-without-reloading" class="md-nav__link">
    <span class="md-ellipsis">
      Updating without reloading
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Updating without reloading">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#catching-the-event" class="md-nav__link">
    <span class="md-ellipsis">
      Catching the event
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#updating-without-reloading" class="md-nav__link">
    <span class="md-ellipsis">
      Updating without reloading
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Updating without reloading">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#catching-the-event" class="md-nav__link">
    <span class="md-ellipsis">
      Catching the event
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="updating-far-away-elements">Updating far away elements</h1>
<p>Let's add an unread count to each feed in the sidebar!</p>
<p>Adding the unread count initially is relatively straightforward. When we load the page, count how many unread entries there are, and put them on the sidebar beside each feed:</p>
<div class="highlight"><span class="filename">templates/feed.html</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="p">&lt;</span><span class="nt">span</span><span class="p">&gt;</span>{{ feed_[&#39;entries&#39;].values() | rejectattr(&quot;read&quot;) | list | length }}<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
</code></pre></div>
<p>This is not the simplest bit of code! Using Jinja filters we build an expression that:</p>
<ul>
<li>Gets the current feed's entries.</li>
<li>Rejects those that have <code>read=True</code>.</li>
<li>Turns it into a list.</li>
<li>Gets the length.</li>
</ul>
<p>We can put that in a span, and we could style it however we want.</p>
<h2 id="updating-without-reloading">Updating without reloading</h2>
<p>The main difficulty with this is that when we mark an entry as read, the sidebar won't reload. We also can't use HTMX out-of-band swaps easily, because the endpoint that marks an entry as read redirects the user to a different site.</p>
<p>So we go back to AlpineJS, where we'll use event-driven development to achieve this.</p>
<p>When we mark an entry as read we're already using AlpineJS to change the state locally:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>x-on:click=&quot;read = true&quot;
</code></pre></div>
<p>AlpineJS also has event handling, so we can dispatch an event here that can then be caught by the span that contains the number of unread entries.</p>
<p>To dispatch an event, we do:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>x-on:click=&quot;$dispatch(&#39;read&#39;); read = true;&quot;
</code></pre></div>
<p>We can include extra data, and we should! A user might click an entry multiple times, so let's include whether the entry has an unread state or not:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>x-on:click=&quot;$dispatch(&#39;read&#39; { read: read }); read = true;
</code></pre></div>
<p>There's a lot of <code>read</code> there! In order:</p>
<ul>
<li><code>'read'</code> is the event name.</li>
<li>In <code>{ read: read }</code>, the first <code>read</code> is the name of the key in the object that we are passing.<ul>
<li>The second <code>read</code> is the current value of the AlpineJS attribute we're using to store whether an entry has been read or not.</li>
</ul>
</li>
<li>After the semicolon, we change the aforementioned status to <code>true</code>. Nothing to do with the event dispatch.</li>
</ul>
<p>You could probably write this line of code better than me!</p>
<p>Here's the full <code>entry.html</code> code with the changed line highlighted:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">templates/partials/entry.html</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-4-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-4-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-4-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-4-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-4-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-4-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-4-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-4-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-4-10">10</a></span>
<span class="normal"><a href="#__codelineno-4-11">11</a></span>
<span class="normal"><a href="#__codelineno-4-12">12</a></span>
<span class="normal"><a href="#__codelineno-4-13">13</a></span>
<span class="normal"><a href="#__codelineno-4-14">14</a></span>
<span class="normal"><a href="#__codelineno-4-15">15</a></span>
<span class="normal"><a href="#__codelineno-4-16">16</a></span>
<span class="normal"><a href="#__codelineno-4-17">17</a></span>
<span class="normal"><a href="#__codelineno-4-18">18</a></span>
<span class="normal"><a href="#__codelineno-4-19">19</a></span>
<span class="normal"><a href="#__codelineno-4-20">20</a></span>
<span class="normal"><a href="#__codelineno-4-21">21</a></span>
<span class="normal"><a href="#__codelineno-4-22">22</a></span>
<span class="normal"><a href="#__codelineno-4-23">23</a></span>
<span class="normal"><a href="#__codelineno-4-24">24</a></span>
<span class="normal"><a href="#__codelineno-4-25">25</a></span>
<span class="normal"><a href="#__codelineno-4-26">26</a></span>
<span class="normal"><a href="#__codelineno-4-27">27</a></span>
<span class="normal"><a href="#__codelineno-4-28">28</a></span>
<span class="normal"><a href="#__codelineno-4-29">29</a></span>
<span class="normal"><a href="#__codelineno-4-30">30</a></span>
<span class="normal"><a href="#__codelineno-4-31">31</a></span>
<span class="normal"><a href="#__codelineno-4-32">32</a></span>
<span class="normal"><a href="#__codelineno-4-33">33</a></span>
<span class="normal"><a href="#__codelineno-4-34">34</a></span>
<span class="normal"><a href="#__codelineno-4-35">35</a></span>
<span class="normal"><a href="#__codelineno-4-36">36</a></span>
<span class="normal"><a href="#__codelineno-4-37">37</a></span>
<span class="normal"><a href="#__codelineno-4-38">38</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a>{#
<a id="__codelineno-4-2" name="__codelineno-4-2"></a>A rendered summarized entry
<a id="__codelineno-4-3" name="__codelineno-4-3"></a>- title
<a id="__codelineno-4-4" name="__codelineno-4-4"></a>- published
<a id="__codelineno-4-5" name="__codelineno-4-5"></a>- summary
<a id="__codelineno-4-6" name="__codelineno-4-6"></a>- media_content (post image)
<a id="__codelineno-4-7" name="__codelineno-4-7"></a>- author
<a id="__codelineno-4-8" name="__codelineno-4-8"></a>- link
<a id="__codelineno-4-9" name="__codelineno-4-9"></a>- read
<a id="__codelineno-4-10" name="__codelineno-4-10"></a>- feed_url
<a id="__codelineno-4-11" name="__codelineno-4-11"></a>#}
<a id="__codelineno-4-12" name="__codelineno-4-12"></a><span class="p">&lt;</span><span class="nt">article</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;grid grid-cols-[300px_600px] mb-4&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-4-13" name="__codelineno-4-13"></a>    {% if media_content %}
<a id="__codelineno-4-14" name="__codelineno-4-14"></a>        <span class="p">&lt;</span><span class="nt">img</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;aspect-video rounded-md shadow-md&quot;</span>
<a id="__codelineno-4-15" name="__codelineno-4-15"></a>             <span class="na">src</span><span class="o">=</span><span class="s">&quot;{{ media_content[0][&#39;url&#39;] }}&quot;</span> <span class="p">/&gt;</span>
<a id="__codelineno-4-16" name="__codelineno-4-16"></a>    {% endif %}
<a id="__codelineno-4-17" name="__codelineno-4-17"></a>    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;ml-8 pt-4 {{ &#39;col-start-2&#39; if media_content else &#39;col-start-1 col-span-2&#39; }}&quot;</span>
<a id="__codelineno-4-18" name="__codelineno-4-18"></a>         <span class="na">x-data</span><span class="o">=</span><span class="s">&quot;{ read: {{ read | lower }} }&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-4-19" name="__codelineno-4-19"></a>        <span class="p">&lt;</span><span class="nt">h2</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;font-bold text-2xl&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-4-20" name="__codelineno-4-20"></a>            <span class="p">&lt;</span><span class="nt">svg</span> <span class="na">x-show</span><span class="o">=</span><span class="s">&quot;!read&quot;</span>
<a id="__codelineno-4-21" name="__codelineno-4-21"></a>                 <span class="na">viewBox</span><span class="o">=</span><span class="s">&quot;0 0 16 16&quot;</span>
<a id="__codelineno-4-22" name="__codelineno-4-22"></a>                 <span class="na">xmlns</span><span class="o">=</span><span class="s">&quot;http://www.w3.org/2000/svg&quot;</span>
<a id="__codelineno-4-23" name="__codelineno-4-23"></a>                 <span class="na">class</span><span class="o">=</span><span class="s">&quot;fill-emerald-500 h-3 w-3 inline-block mb-1&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-4-24" name="__codelineno-4-24"></a>                <span class="p">&lt;</span><span class="nt">circle</span> <span class="na">cx</span><span class="o">=</span><span class="s">&quot;8&quot;</span> <span class="na">cy</span><span class="o">=</span><span class="s">&quot;8&quot;</span> <span class="na">r</span><span class="o">=</span><span class="s">&quot;8&quot;</span> <span class="p">/&gt;</span>
<a id="__codelineno-4-25" name="__codelineno-4-25"></a>            <span class="p">&lt;/</span><span class="nt">svg</span><span class="p">&gt;</span>
<a id="__codelineno-4-26" name="__codelineno-4-26"></a>            {{ title }}
<a id="__codelineno-4-27" name="__codelineno-4-27"></a>        <span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<a id="__codelineno-4-28" name="__codelineno-4-28"></a>        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-4-29" name="__codelineno-4-29"></a>            Published by <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;font-medium&quot;</span><span class="p">&gt;</span>{{ author }}<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span> on <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;font-medium&quot;</span><span class="p">&gt;</span>{{ published
<a id="__codelineno-4-30" name="__codelineno-4-30"></a>        }}<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<a id="__codelineno-4-31" name="__codelineno-4-31"></a>    <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<a id="__codelineno-4-32" name="__codelineno-4-32"></a>    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;leading-6 mb-2&quot;</span><span class="p">&gt;</span>{{ summary }}<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-4-33" name="__codelineno-4-33"></a><span class="hll">    <span class="p">&lt;</span><span class="nt">a</span> <span class="na">x-on:click</span><span class="o">=</span><span class="s">&quot;$dispatch(&#39;read&#39;, {read: read}); read = true;&quot;</span>
</span><a id="__codelineno-4-34" name="__codelineno-4-34"></a>       <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{ url_for(&#39;read_entry&#39;, feed_url=feed_url, entry_url=link) }}&quot;</span>
<a id="__codelineno-4-35" name="__codelineno-4-35"></a>       <span class="na">class</span><span class="o">=</span><span class="s">&quot;underline&quot;</span>
<a id="__codelineno-4-36" name="__codelineno-4-36"></a>       <span class="na">target</span><span class="o">=</span><span class="s">&quot;_blank&quot;</span><span class="p">&gt;</span>Read article<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="__codelineno-4-37" name="__codelineno-4-37"></a><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-4-38" name="__codelineno-4-38"></a><span class="p">&lt;/</span><span class="nt">article</span><span class="p">&gt;</span>
</code></pre></div></td></tr></table></div>
<h3 id="catching-the-event">Catching the event</h3>
<p>AlpineJS will bubble up the event upwards through any HTML container <em>that is itself also an AlpineJS component</em>.</p>
<p>At the moment, there are no common ancestors of the entry and the sidebar which are AlpineJS components. So there is no way for this event to be caught by the sidebar <code>span</code>.</p>
<p>Let's find a common ancestor of entries and the sidebar: the <code>body</code>.</p>
<p>We could structure our HTML page a bit better, put everything inside a <code>div</code> and use that. But we've got what we've got, and the <code>body</code> is a fine element.</p>
<p>Let's make the <code>body</code> an AlpineJS component so that the event can bubble up to it and be caught by any of its children.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>&lt;body x-data&gt;
</code></pre></div>
<p>We don't need to put anything in <code>x-data</code>, just doing this does what we need.</p>
<p>Now we can go to the event and add some logic there to catch the event. If the current status of the entry is unread, then we can decrease the number in the badge by 1:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="p">&lt;</span><span class="nt">span</span> <span class="err">@</span><span class="na">read</span><span class="err">.</span><span class="na">window</span><span class="o">=</span><span class="s">&quot;{{ &#39;$el.innerHTML -= $event.detail.read ? 0 : 1&#39; if feed.href == feed_[&#39;href&#39;] else &#39;&#39; }}&quot;</span><span class="p">&gt;</span>{{ feed_[&#39;entries&#39;].values() | rejectattr(&quot;read&quot;) | list | length }}<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
</code></pre></div>
<p>We also need to make sure that we're only decreasing the number in the <em>currently active feed</em>, as that's the only feed in which we could be clicking an article. Otherwise, all feeds would see their unread article count lower.</p>
<p>Here's the final code for the feed with changed lines highlighted:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">templates/feed.html</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span>
<span class="normal"><a href="#__codelineno-7-12">12</a></span>
<span class="normal"><a href="#__codelineno-7-13">13</a></span>
<span class="normal"><a href="#__codelineno-7-14">14</a></span>
<span class="normal"><a href="#__codelineno-7-15">15</a></span>
<span class="normal"><a href="#__codelineno-7-16">16</a></span>
<span class="normal"><a href="#__codelineno-7-17">17</a></span>
<span class="normal"><a href="#__codelineno-7-18">18</a></span>
<span class="normal"><a href="#__codelineno-7-19">19</a></span>
<span class="normal"><a href="#__codelineno-7-20">20</a></span>
<span class="normal"><a href="#__codelineno-7-21">21</a></span>
<span class="normal"><a href="#__codelineno-7-22">22</a></span>
<span class="normal"><a href="#__codelineno-7-23">23</a></span>
<span class="normal"><a href="#__codelineno-7-24">24</a></span>
<span class="normal"><a href="#__codelineno-7-25">25</a></span>
<span class="normal"><a href="#__codelineno-7-26">26</a></span>
<span class="normal"><a href="#__codelineno-7-27">27</a></span>
<span class="normal"><a href="#__codelineno-7-28">28</a></span>
<span class="normal"><a href="#__codelineno-7-29">29</a></span>
<span class="normal"><a href="#__codelineno-7-30">30</a></span>
<span class="normal"><a href="#__codelineno-7-31">31</a></span>
<span class="normal"><a href="#__codelineno-7-32">32</a></span>
<span class="normal"><a href="#__codelineno-7-33">33</a></span>
<span class="normal"><a href="#__codelineno-7-34">34</a></span>
<span class="normal"><a href="#__codelineno-7-35">35</a></span>
<span class="normal"><a href="#__codelineno-7-36">36</a></span>
<span class="normal"><a href="#__codelineno-7-37">37</a></span>
<span class="normal"><a href="#__codelineno-7-38">38</a></span>
<span class="normal"><a href="#__codelineno-7-39">39</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a>{% extends &quot;base.html&quot; %}
<a id="__codelineno-7-2" name="__codelineno-7-2"></a>{% block content %}
<a id="__codelineno-7-3" name="__codelineno-7-3"></a>  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;hidden lg:fixed lg:inset-y-0 lg:z-50 lg:flex lg:w-72 lg:flex-col&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a>    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;flex grow flex-col gap-y-5 overflow-y-auto bg-white px-6 py-4&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-7-5" name="__codelineno-7-5"></a>      <span class="p">&lt;</span><span class="nt">nav</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;flex flex-1 flex-col&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-7-6" name="__codelineno-7-6"></a>        <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">role</span><span class="o">=</span><span class="s">&quot;list&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;flex flex-1 flex-col gap-y-3&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-7-7" name="__codelineno-7-7"></a>          {% for feed_url, feed_ in feeds.items() %}
<a id="__codelineno-7-8" name="__codelineno-7-8"></a>            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>
<a id="__codelineno-7-9" name="__codelineno-7-9"></a>              <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{ url_for(&#39;render_feed&#39;, feed_url=feed_.href) }}&quot;</span>
<a id="__codelineno-7-10" name="__codelineno-7-10"></a>                 <span class="na">hx-boost</span>
<a id="__codelineno-7-11" name="__codelineno-7-11"></a>                 <span class="na">class</span><span class="o">=</span><span class="s">&quot;{{ &#39;bg-green-700 text-white&#39; if feed.href == feed_[&#39;href&#39;] else &#39;&#39; }} group flex gap-x-3 rounded-md p-2 text-sm leading-6 font-semibold&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-7-12" name="__codelineno-7-12"></a>                {{ feed_[&#39;title&#39;] }}
<a id="__codelineno-7-13" name="__codelineno-7-13"></a><span class="hll">                <span class="p">&lt;</span><span class="nt">span</span> <span class="err">@</span><span class="na">read</span><span class="err">.</span><span class="na">window</span><span class="o">=</span><span class="s">&quot;{{ &#39;$el.innerHTML -= $event.detail.read ? 0 : 1&#39; if feed.href == feed_[&#39;href&#39;] else &#39;&#39; }}&quot;</span><span class="p">&gt;</span>{{ feed_[&#39;entries&#39;].values() | rejectattr(&quot;read&quot;) | list | length }}<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
</span><a id="__codelineno-7-14" name="__codelineno-7-14"></a>              <span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
<a id="__codelineno-7-15" name="__codelineno-7-15"></a>            <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<a id="__codelineno-7-16" name="__codelineno-7-16"></a>          {% endfor %}
<a id="__codelineno-7-17" name="__codelineno-7-17"></a>        <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
<a id="__codelineno-7-18" name="__codelineno-7-18"></a>      <span class="p">&lt;/</span><span class="nt">nav</span><span class="p">&gt;</span>
<a id="__codelineno-7-19" name="__codelineno-7-19"></a>      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;flex flex-col justify-center items-center&quot;</span>
<a id="__codelineno-7-20" name="__codelineno-7-20"></a>           <span class="na">x-data</span><span class="o">=</span><span class="s">&quot;{show: false}&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-7-21" name="__codelineno-7-21"></a>        <span class="cm">&lt;!-- The below doesn&#39;t need to be a partial anymore because we&#39;re never rendering it in a Flask endpoint --&gt;</span>
<a id="__codelineno-7-22" name="__codelineno-7-22"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">x-show</span><span class="o">=</span><span class="s">&quot;show&quot;</span><span class="p">&gt;</span>{{ render_partial(&quot;partials/add_feed.html&quot;) }}<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-7-23" name="__codelineno-7-23"></a>        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">x-on:click</span><span class="o">=</span><span class="s">&quot;show = !show&quot;</span>
<a id="__codelineno-7-24" name="__codelineno-7-24"></a>                <span class="na">class</span><span class="o">=</span><span class="s">&quot;bg-slate-600 text-white font-semibold rounded-md px-4 py-2&quot;</span>
<a id="__codelineno-7-25" name="__codelineno-7-25"></a>                <span class="na">x-text</span><span class="o">=</span><span class="s">&quot;show ? &#39;Hide&#39; : &#39;Show&#39;&quot;</span><span class="p">&gt;</span>Show<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<a id="__codelineno-7-26" name="__codelineno-7-26"></a>      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-7-27" name="__codelineno-7-27"></a>    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-7-28" name="__codelineno-7-28"></a>  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-7-29" name="__codelineno-7-29"></a>  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;pl-72&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-7-30" name="__codelineno-7-30"></a>    <span class="p">&lt;</span><span class="nt">main</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;py-10&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-7-31" name="__codelineno-7-31"></a>      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;px-4 sm:px-6 lg:px-8&quot;</span>
<a id="__codelineno-7-32" name="__codelineno-7-32"></a>           <span class="na">id</span><span class="o">=</span><span class="s">&quot;entries&quot;</span>
<a id="__codelineno-7-33" name="__codelineno-7-33"></a>           <span class="na">hx-get</span><span class="o">=</span><span class="s">&quot;{{ url_for(&#39;render_feed_entries&#39;, feed_url=feed.href, page=0) }}&quot;</span>
<a id="__codelineno-7-34" name="__codelineno-7-34"></a>           <span class="na">hx-swap</span><span class="o">=</span><span class="s">&quot;afterbegin&quot;</span>
<a id="__codelineno-7-35" name="__codelineno-7-35"></a>           <span class="na">hx-target</span><span class="o">=</span><span class="s">&quot;this&quot;</span>
<a id="__codelineno-7-36" name="__codelineno-7-36"></a>           <span class="na">hx-trigger</span><span class="o">=</span><span class="s">&quot;load&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-7-37" name="__codelineno-7-37"></a>    <span class="p">&lt;/</span><span class="nt">main</span><span class="p">&gt;</span>
<a id="__codelineno-7-38" name="__codelineno-7-38"></a>  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-7-39" name="__codelineno-7-39"></a>{% endblock content %}
</code></pre></div></td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code>@read</code> is the event name, and <code>@read.window</code> makes it so the <code>span</code> can catch the event even if it wasn't emitted by a child component.</p>
</div>
<p>With this, we're done! We've rapidly built a simple app that is just interactive enough, simple to understand, and very fast to incrementally update.</p>
<p>Thank you for reading, and I hope you've enjoyed this session!</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "content.code.annotate"], "search": "../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
    
  </body>
</html>